<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="bbs">
	<select id="list" resultType="mateBoardListDTO">
		SELECT
		mb.id AS mateBoardId,
		u.nickname AS nickname,
		mb.content AS content,
		mb.title AS title,
		mb.thumbnail AS thumbnail,
		mb.start_date AS startDate,
		mb.end_date AS endDate,
		ar.range_description AS ageRange
		FROM
		mate_board mb
		JOIN user u ON mb.user_id = u.id
		JOIN age_range ar ON mb.age_range_id = ar.id
		<where>
			<if test='searchType != null'>
				<if test='searchType.equals("title")'>
					AND title LIKE concat('%', #{keyword}, '%')
				</if>
				<if test='searchType.equals("content")'>
					AND content LIKE concat('%', #{keyword}, '%')
				</if>
				<if test='searchType.equals("title_content")'>
					AND title LIKE concat('%', #{keyword}, '%')
					or content LIKE concat('%', #{keyword}, '%')
				</if>
				<if test='searchType.equals("nickname")'>
					AND nickname LIKE concat('%', #{keyword}, '%')
				</if>
<!--				<if test='searchType.equals("id")'>-->
<!--					AND mb.id BETWEEN #{start} AND #{end}-->
<!--				</if>-->
			</if>
		</where>
		AND mb.id BETWEEN #{start} AND #{end}
		ORDER BY
		mb.id DESC;
	</select>




	<!--	<select id="list" resultType="mateBoardListDTO">-->
<!--		SELECT-->
<!--		mb.id AS mateBoardId,-->
<!--		u.nickname AS nickname,-->
<!--		mb.content AS content,-->
<!--		mb.title AS title,-->
<!--		mb.thumbnail AS thumbnail,-->
<!--		mb.start_date AS startDate,-->
<!--		mb.end_date AS endDate,-->
<!--		ar.range_description AS ageRange-->
<!--		FROM-->
<!--		mate_board mb-->
<!--		JOIN user u ON mb.user_id = u.id-->
<!--		JOIN age_range ar ON mb.age_range_id = ar.id-->
<!--		WHERE-->
<!--		mb.id BETWEEN #{start} AND #{end}-->
<!--		ORDER BY-->
<!--		mb.id DESC;-->
<!--	</select>-->

	<select id="count" resultType="Integer">
		select count(*) from mate_board;
	</select>

	<select id ="location" resultType="locationDTO">
		SELECT id as locationId,
		city as city
		FROM location;
	</select>
</mapper>











