-- hontrip_test.age_range definition

CREATE TABLE `age_range` (
  `id` int NOT NULL,
  `range_description` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- hontrip_test.flight definition

CREATE TABLE `flight` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `vehicle_id` varchar(10) NOT NULL,
  `airline_name` varchar(10) NOT NULL,
  `departure_airport_name` varchar(10) NOT NULL,
  `departure_time` varchar(20) NOT NULL,
  `arrival_airport_name` varchar(10) NOT NULL,
  `arrival_time` varchar(20) NOT NULL,
  `economy_charge` varchar(10) DEFAULT NULL,
  `prestige_charge` varchar(10) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- hontrip_test.location definition

CREATE TABLE `location` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `city` varchar(50) NOT NULL,
  `lat` double NOT NULL,
  `lon` double NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=188 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- hontrip_test.plan_category definition

CREATE TABLE `plan_category` (
  `category_id` int NOT NULL AUTO_INCREMENT,
  `category_name` varchar(50) NOT NULL,
  PRIMARY KEY (`category_id`)
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- hontrip_test.safety definition

CREATE TABLE `safety` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `create_date` timestamp NOT NULL,
  `location_id` varchar(100) NOT NULL,
  `location_name` varchar(500) NOT NULL,
  `md101_sn` varchar(100) NOT NULL,
  `msg` text NOT NULL,
  `send_platform` varchar(100) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- hontrip_test.spot definition

CREATE TABLE `spot` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `content_id` varchar(20) NOT NULL,
  `content_type` varchar(2) NOT NULL,
  `title` varchar(50) NOT NULL,
  `tel` varchar(50) DEFAULT NULL,
  `image` varchar(255) DEFAULT NULL,
  `homepage` varchar(255) DEFAULT NULL,
  `address` varchar(100) NOT NULL,
  `mapX` varchar(50) NOT NULL,
  `mapY` varchar(50) NOT NULL,
  `areacode` varchar(10) DEFAULT NULL,
  `sigungucode` varchar(10) DEFAULT NULL,
  `overview` text,
  `info_center` varchar(255) DEFAULT NULL,
  `open_date` varchar(255) DEFAULT NULL,
  `rest_date` varchar(255) DEFAULT NULL,
  `exp_guide` text,
  `usetime` varchar(255) DEFAULT NULL,
  `parking` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- hontrip_test.accommodation definition

CREATE TABLE `accommodation` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `category_id` int DEFAULT '1',
  `place_name` varchar(255) NOT NULL,
  `address_name` varchar(255) NOT NULL,
  `road_address_name` varchar(255) DEFAULT NULL,
  `phone` varchar(20) DEFAULT NULL,
  `longitude` float NOT NULL,
  `latitude` float NOT NULL,
  `place_url` varchar(255) DEFAULT NULL,
  `distance` float DEFAULT NULL,
  `kakao_map_url` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `category_id` (`category_id`),
  CONSTRAINT `accommodation_ibfk_1` FOREIGN KEY (`category_id`) REFERENCES `plan_category` (`category_id`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- hontrip_test.emergency_facility definition

CREATE TABLE `emergency_facility` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `category_id` int NOT NULL,
  `place_name` varchar(255) NOT NULL,
  `address_name` varchar(255) NOT NULL,
  `road_address_name` varchar(255) DEFAULT NULL,
  `phone` varchar(20) DEFAULT NULL,
  `longitude` float NOT NULL,
  `latitude` float NOT NULL,
  `place_url` varchar(255) DEFAULT NULL,
  `distance` float DEFAULT NULL,
  `kakao_map_url` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `category_id` (`category_id`),
  CONSTRAINT `emergency_facility_ibfk_1` FOREIGN KEY (`category_id`) REFERENCES `plan_category` (`category_id`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- hontrip_test.`user` definition

CREATE TABLE `user` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `provider` varchar(20) NOT NULL,
  `social_id` varchar(255) NOT NULL,
  `nickname` varchar(255) DEFAULT NULL,
  `profile_image` varchar(1000) DEFAULT NULL,
  `gender` tinyint DEFAULT NULL,
  `age_range_id` int DEFAULT NULL,
  `email` varchar(255) DEFAULT NULL,
  `access_token` varchar(255) DEFAULT NULL,
  `expires_at` date DEFAULT NULL,
  `refresh_token` varchar(255) DEFAULT NULL,
  `refresh_token_expires_at` date DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `age_range_id` (`age_range_id`),
  CONSTRAINT `user_ibfk_1` FOREIGN KEY (`age_range_id`) REFERENCES `age_range` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

ALTER TABLE `user`
MODIFY COLUMN `expires_at` TIMESTAMP NULL DEFAULT NULL;

ALTER TABLE `user`
MODIFY COLUMN `refresh_token_expires_at` TIMESTAMP NULL DEFAULT NULL;


-- hontrip_test.mate_board definition

CREATE TABLE `mate_board` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '매칭 게시판 구분',
  `user_id` bigint NOT NULL COMMENT '게시글 작성자 아이디',
  `region_id` bigint NOT NULL COMMENT '도시 표시',
  `age_range_id` int NOT NULL COMMENT '연령대 표시',
  `title` varchar(30) NOT NULL COMMENT '제목',
  `content` text NOT NULL COMMENT '내용',
  `thumbnail` varchar(255) NOT NULL COMMENT '썸네일',
  `start_date` date NOT NULL COMMENT '여행 시작 날짜',
  `end_date` date NOT NULL COMMENT '여행 종료 날짜',
  `recruit_number` int NOT NULL COMMENT '모집인원',
  `gender` tinyint NOT NULL COMMENT '성별 0(male), 1(female), 2(none)',
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT ' 게시글 작성 일자',
  `updated_at` timestamp NULL DEFAULT NULL COMMENT '게시글 수정 일자',
  `is_finish` tinyint NOT NULL DEFAULT '0' COMMENT '동행자 모집 완료(1) 또는 모집중(0)',
  PRIMARY KEY (`id`),
  KEY `user_id` (`user_id`),
  KEY `region_id` (`region_id`),
  KEY `age_range_id` (`age_range_id`),
  CONSTRAINT `mate_board_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`),
  CONSTRAINT `mate_board_ibfk_2` FOREIGN KEY (`region_id`) REFERENCES `location` (`id`),
  CONSTRAINT `mate_board_ibfk_3` FOREIGN KEY (`age_range_id`) REFERENCES `age_range` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- hontrip_test.mate_comment definition

CREATE TABLE `mate_comment` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '댓글 구분',
  `mate_board_id` bigint NOT NULL COMMENT '매칭 게시판 구분',
  `user_id` bigint NOT NULL COMMENT '댓글 작성자 아이디',
  `content` varchar(255) NOT NULL COMMENT '내용',
  `comment_sequence` int NOT NULL COMMENT '댓글순서',
  `comments_sequence` int NOT NULL DEFAULT '0' COMMENT '대댓글순서',
  `indentation_number` int NOT NULL DEFAULT '0' COMMENT '들여쓰기횟수',
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '작성 일자',
  `updated_at` timestamp NULL DEFAULT NULL COMMENT '수정일자',
  PRIMARY KEY (`id`),
  KEY `mate_board_id` (`mate_board_id`),
  KEY `user_id` (`user_id`),
  CONSTRAINT `mate_comment_ibfk_1` FOREIGN KEY (`mate_board_id`) REFERENCES `mate_board` (`id`),
  CONSTRAINT `mate_comment_ibfk_2` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- hontrip_test.mate_matching_alarm definition

CREATE TABLE `mate_matching_alarm` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '알림 구분',
  `mate_board_id` bigint NOT NULL COMMENT '매칭 게시판 구분',
  `sender_id` bigint NOT NULL COMMENT '동행인 매칭 신청한 유저 아이디',
  `content` varchar(100) NOT NULL DEFAULT '같이 여행가요!' COMMENT '동행인 신청 버튼을 누르면 신청자가 메세지를 작성한다',
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '작성일자',
  `is_read` tinyint NOT NULL DEFAULT '0' COMMENT '읽음 여부',
  PRIMARY KEY (`id`),
  KEY `mate_board_id` (`mate_board_id`),
  KEY `sender_id` (`sender_id`),
  CONSTRAINT `mate_matching_alarm_ibfk_1` FOREIGN KEY (`mate_board_id`) REFERENCES `mate_board` (`id`),
  CONSTRAINT `mate_matching_alarm_ibfk_2` FOREIGN KEY (`sender_id`) REFERENCES `user` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- hontrip_test.plan definition

CREATE TABLE `plan` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `user_id` bigint NOT NULL,
  `title` varchar(255) NOT NULL,
  `start_date` date NOT NULL,
  `end_date` date NOT NULL,
  `memo` text,
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `user_id` (`user_id`),
  CONSTRAINT `plan_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- hontrip_test.plan_day definition

CREATE TABLE `plan_day` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `user_id` bigint NOT NULL,
  `plan_id` bigint DEFAULT NULL,
  `spot_id` bigint DEFAULT NULL,
  `accommodation_id` bigint DEFAULT NULL,
  `flight_id` bigint DEFAULT NULL,
  `day_order` int DEFAULT NULL,
  `item_type` varchar(255) DEFAULT NULL,
  `item_order` int DEFAULT NULL,
  PRIMARY KEY (`id`,`user_id`),
  KEY `plan_day_FK` (`user_id`),
  KEY `plan_day_FK_1` (`plan_id`),
  KEY `plan_day_FK_2` (`spot_id`),
  KEY `plan_day_FK_3` (`accommodation_id`),
  KEY `plan_day_FK_4` (`flight_id`),
  CONSTRAINT `plan_day_FK` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `plan_day_FK_1` FOREIGN KEY (`plan_id`) REFERENCES `plan` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `plan_day_FK_2` FOREIGN KEY (`spot_id`) REFERENCES `spot` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `plan_day_FK_3` FOREIGN KEY (`accommodation_id`) REFERENCES `accommodation` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `plan_day_FK_4` FOREIGN KEY (`flight_id`) REFERENCES `flight` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- hontrip_test.record_board definition

CREATE TABLE `record_board` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `user_id` bigint NOT NULL,
  `location_id` bigint NOT NULL,
  `title` varchar(100) NOT NULL,
  `content` text NOT NULL,
  `is_visible` tinyint NOT NULL,
  `thumbnail` varchar(100) NOT NULL,
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `user_id` (`user_id`),
  KEY `location_id` (`location_id`),
  CONSTRAINT `record_board_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`),
  CONSTRAINT `record_board_ibfk_2` FOREIGN KEY (`location_id`) REFERENCES `location` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- hontrip_test.record_comment definition

CREATE TABLE `record_comment` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `comment_writer_id` bigint NOT NULL,
  `record_id` bigint NOT NULL,
  `content` varchar(255) NOT NULL,
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NULL DEFAULT NULL,
  `comment_sequence` int DEFAULT NULL,
  `comments_sequence` int DEFAULT NULL,
  `indentation_number` int DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `record_id` (`record_id`),
  KEY `comment_writer_id` (`comment_writer_id`),
  CONSTRAINT `record_comment_ibfk_1` FOREIGN KEY (`record_id`) REFERENCES `record_board` (`id`) ON DELETE CASCADE,
  CONSTRAINT `record_comment_ibfk_2` FOREIGN KEY (`comment_writer_id`) REFERENCES `user` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- hontrip_test.record_img definition

CREATE TABLE `record_img` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `img_url` varchar(100) NOT NULL,
  `record_id` bigint NOT NULL,
  PRIMARY KEY (`id`),
  KEY `record_id` (`record_id`),
  CONSTRAINT `record_img_ibfk_1` FOREIGN KEY (`record_id`) REFERENCES `record_board` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- hontrip_test.record_like definition

CREATE TABLE `record_like` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `user_id` bigint NOT NULL,
  `record_id` bigint NOT NULL,
  PRIMARY KEY (`id`),
  KEY `record_id` (`record_id`),
  KEY `user_id` (`user_id`),
  CONSTRAINT `record_like_ibfk_1` FOREIGN KEY (`record_id`) REFERENCES `record_board` (`id`) ON DELETE CASCADE,
  CONSTRAINT `record_like_ibfk_2` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;